{% extends "base.html" %}<!--extends the base.html template-->

{% block title %}Home{% endblock %}<!--Override the default name from the base.html template-->

{% block content %} 

<style>
    .item1 { grid-area: header; }
    .item2 { grid-area: news; }
    .item3 { grid-area: gain; }
    .item4 { grid-area: loose; }
    .grid-container {
        display: grid;
        grid-template-areas:
            'header header header header header header'
            'news news news gain gain gain'
            'news news news loose loose loose';
        gap: 10px;
        background-color: #b1c1ce;
        padding: 10px;
        }

        .grid-container > div {
            background-color: rgba(255, 255, 255, 0.8);
            text-align: center;
            padding: 20px 0;
            font-size: 30px;
            
            }
</style>

<!--full-height image -->
<div class="grid-container" style="padding-top:20px">
    <!-- GRAPHS -->
    <div class="w3-row-padding item1">
        <div class="w3-center w3-padding-64">
            <h3><b>DAILY MARKET CHARTS</b></h4>
        </div>
        <div class="w3-third w3-margin-bottom">
            <div class="w3-border w3-center">
                <div id="Dow">
                    <canvas id="dowChart"></canvas>
               </div>
            </div>
        </div>
        <div class="w3-third w3-margin-bottom">
            <div class="w3-border w3-center">
                <div id="Dow">
                    <canvas id="nasdaqChart"></canvas>
               </div>
            </div>
        </div>
        <div class="w3-third w3-margin-bottom">
            <div class="w3-border w3-center">
                <div id="Dow">
                    <canvas id="SP500Chart"></canvas>
               </div>
            </div>
        </div>
    
    </div>
    
    <div class="w3-row-padding item2">
        <!-- NEW Slideshow -->
        
        <!-- Slideshow -->
        <div class="w3-container">
            <h3 class="w3-padding-48"><b>LATEST MARKET NEWS</b></h3>
            {% for title, desc,img,p_date,url in contents %}
            <div class="w3-display-container mySlides" >
                <img src ="{{img}}" style=" width: 820px; height: 560px;">
                <div class="w3-black w3-container w3-padding-12" style=" width: 820px; max-height: 350px; font-size: 1.2vw;" >
                    <h4>{{title}}</h4>
                    <p>{{desc}}</p>
                    <p><a href="{{url}}">READ MORE</a></p>
                </div>
            </div>
            {% endfor %}
            <!-- Slideshow next/previous buttons -->
            <div class="w3-container w3-dark-grey w3-padding w3-xlarge" style=" width: 820px;">
                <div class="w3-left" onclick="plusDivs(-1)"><i class="fa fa-arrow-circle-left w3-hover-text-teal"></i></div>
                <div class="w3-right" onclick="plusDivs(1)"><i class="fa fa-arrow-circle-right w3-hover-text-teal"></i></div>
            </div>
        </div>
    </div>

    <!--Daily stock graph table-->
    <div class="w3-row-padding item3">
        <h3 class="w3-padding-64"><b>HIGHEST PERCENTAGE GAIN STOCKS</b></h3>
    </div>

    <div class="w3-row-padding item4">
        <h3 class="w3-padding-64"><b>HIGHEST PERCENTAGE LOOSE STOCKS</b></h3>
    </div>
    
    
    <!-- OLD NEWSFEED
    <div class=" newsfeet">
        <div class="slider">
            {% for title, desc,img,p_date,url in contents %}
            <div class="slide">
                <img src = "{{img}}">
                <div class="info">
                    <h2>{{title}}</h2>
                    <p>{{desc}}<br><a href="{{url}}">READ MORE</a></p>
                    
                </div>
            </div>
            {% endfor %}
            <div class="navigation">
                <i class="fas fa-chevron-left prev-btn"></i>
                <i class="fas fa-chevron-right next-btn"></i>
            </div>
        </div>
    </div>
    -->
</div>

<script>
    // Slideshow
    var slideIndex = 1;
    showDivs(slideIndex);
    
    function plusDivs(n) {
      showDivs(slideIndex += n);
    }
    
    function currentDiv(n) {
      showDivs(slideIndex = n);
    }
    
    function showDivs(n) {
      var i;
      var x = document.getElementsByClassName("mySlides");
      var dots = document.getElementsByClassName("demodots");
      if (n > x.length) {slideIndex = 1}    
      if (n < 1) {slideIndex = x.length} ;
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";  
      }
      for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" w3-white", "");
      }
      x[slideIndex-1].style.display = "block";  
      dots[slideIndex-1].className += " w3-white";
    }
</script>
    

<script>
    let xhr = new XMLHttpRequest();
    xhr.open('GET','http://127.0.0.1:5000/search?time=3mo&stock=Dow',true);
    xhr.onload= function(){
    if(this.status == 200){
        let information = JSON.parse(this.responseText);
        let dates=JSON.parse(information[1]);
        let price =JSON.parse(information[0]);
        var ctx = document.getElementById("dowChart").getContext("2d");
    // Gradient fill
    let gradient = ctx.createLinearGradient(0,0,0,400);
    gradient.addColorStop(0,'rgba(58,123,213,1)');
    gradient.addColorStop(1,'rgba(0,210,255,0.3)');
    const data = {
    labels: dates,
    datasets: [{
    label: 'My First dataset',
    backgroundColor: 'rgb(255, 99, 132)',
    borderColor: 'rgb(255, 99, 132)',
    data:price,
    fill : true,
    backgroundColor : gradient
    }]
    };
    const config = {
        type: 'line',
        data: data,
        options: {
        elements: {
        point:{
            radius : 0
        }
        },
    scales :{
        x:{
        ticks:{
            display : false
            }
        }

        } 
    }
};


var newmychart = new Chart(ctx,config);

    }}
    xhr.send();

    //nasdaq
let xhrnas = new XMLHttpRequest();
    xhrnas.open('GET','http://127.0.0.1:5000/search?time=3mo&stock=Dow',true);
    xhrnas.onload= function(){
    if(this.status == 200){
        let information = JSON.parse(this.responseText);
        let dates=JSON.parse(information[1]);
        let price =JSON.parse(information[0]);
        var ctx = document.getElementById("nasdaqChart").getContext("2d");
    // Gradient fill
    let gradient = ctx.createLinearGradient(0,0,0,400);
    gradient.addColorStop(0,'rgba(58,123,213,1)');
    gradient.addColorStop(1,'rgba(0,210,255,0.3)');
    const data = {
    labels: dates,
    datasets: [{
    label: 'My First dataset',
    backgroundColor: 'rgb(255, 99, 132)',
    borderColor: 'rgb(255, 99, 132)',
    data:price,
    fill : true,
    backgroundColor : gradient
    }]
    };
    const config = {
        type: 'line',
        data: data,
        options: {
        elements: {
        point:{
            radius : 0
        }
        },
    scales :{
        x:{
        ticks:{
            display : false
            }
        }

        } 
    }
};


var nasychart = new Chart(ctx,config);

    }}
    xhrnas.send();
    //sp500
let xhrsp = new XMLHttpRequest();
    xhrsp.open('GET','http://127.0.0.1:5000/search?time=3mo&stock=Dow',true);
    xhrsp.onload= function(){
    if(this.status == 200){
        let information = JSON.parse(this.responseText);
        let dates=JSON.parse(information[1]);
        let price =JSON.parse(information[0]);
        var ctx = document.getElementById("SP500Chart").getContext("2d");
    // Gradient fill
    let gradient = ctx.createLinearGradient(0,0,0,400);
    gradient.addColorStop(0,'rgba(58,123,213,1)');
    gradient.addColorStop(1,'rgba(0,210,255,0.3)');
    const data = {
    labels: dates,
    datasets: [{
    label: 'My First dataset',
    backgroundColor: 'rgb(255, 99, 132)',
    borderColor: 'rgb(255, 99, 132)',
    data:price,
    fill : true,
    backgroundColor : gradient
    }]
    };
    const config = {
        type: 'line',
        data: data,
        options: {
        elements: {
        point:{
            radius : 0
        }
        },
    scales :{
        x:{
        ticks:{
            display : false
            }
        }

        } 
    }
};


var spychart = new Chart(ctx,config);

    }}
    xhrsp.send();
</script>

{% endblock %}
