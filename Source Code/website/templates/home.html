{% extends "base.html" %}<!--extends the base.html template-->

{% block title %}Home{% endblock %}<!--Override the default name from the base.html template-->

{% block content %} 

<style>
    .newsfeet{
        height: 550px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #9596a3;
    }

    .slider{
        position: relative;
        background-color: #000116;
        width: 800px;
        min-height: 500px;
        margin: 20px;
        overflow: hidden;
        border-radius: 10px;
    }

    .slider .slide{
        position: absolute;
        width: 100%;
        height:100%;


    }

    .slider .slide img{
        position: absolute;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .slider .slide .info{
        position: absolute;
        color: #222;
        background-color: rgba(255,255,255,0.3);
        width: 75%;
        margin-top: 50px;
        margin-left: 50px;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 5px 25px rgb(1 1 1/5%);

    }

    .slider .slide .info .h2{
        font-size: 2em;
        font-weight: 800;
    }

    .slider .slide .info .p{
        font: 1em;
        font-weight: 400;
    }

    .navigation{
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    slider:hover .navigation{
        opacity: 1;
    }

    .prev-btn .next-btn{
        z-index: 999;
        font-size: 2em;
        color:#222;
        background-color: rgba(255,255,255,0.8);
        padding: 10px;
        cursor: pointer;
    }

    .prev-btn
    .graphs{
        position: absolute;
        padding-top: 1000px;
    }
</style>

<!--full-height image -->
<div class="w3-display-container w3-grayscale-min">
    <img src="../static/images/cover.png" style="width:100%">
    <div class="w3-display-left w3-text-white" style="padding:48px">
        <span class="w3-jumbo w3-hide-medium w3-hide-small">Financial Investment Analysis Application</span><br>
        <span class="w3-xxlarge w3-hide-large">Financial Investment Analysis Applications</span>
    </div> 
    <div class="w3-display-bottomleft w3-text-grey w3-large" style="padding:24px 48px">
        <i class="fa fa-facebook-official w3-hover-opacity"></i>
        <i class="fa fa-instagram w3-hover-opacity"></i>
        <i class="fa fa-twitter w3-hover-opacity"></i>
        <i class="fa fa-linkedin w3-hover-opacity"></i>
    </div>
</div>

<!--graph-->
<div class= "graphs" >
    <div id="Dow">
         <canvas id="dowChart"></canvas>
    </div>
    <div id="Nas">
         <canvas id="nasdaqChart"></canvas>
    </div>
    <div id="SP">
         <canvas id="SP500Chart"></canvas>
    </div>
</div>

<h4 align="center" style="margin-top: 20px;"> <b>LASTEST MARKET NEWS</b></h4>

<div class=" newsfeet">
    <div class="slider">
        {% for title, desc,img,p_date,url in contents %}
        <div class="slide">
            <img src = "{{img}}">
            <div class="info">
                <h2>{{title}}</h2>
                <p>{{desc}}<br><a href="{{url}}">READ MORE</a></p>
                
            </div>
        </div>
        {% endfor %}
        <div class="navigation">
            <i class="fas fa-chevron-left prev-btn"></i>
            <i class="fas fa-chevron-right next-btn"></i>
        </div>
    </div>
</div>

<script>
    let xhr = new XMLHttpRequest();
    xhr.open('GET','http://127.0.0.1:5000/search?time=3mo&stock=Dow',true);
    xhr.onload= function(){
    if(this.status == 200){
        let information = JSON.parse(this.responseText);
        let dates=JSON.parse(information[1]);
        let price =JSON.parse(information[0]);
        var ctx = document.getElementById("dowChart").getContext("2d");
    // Gradient fill
    let gradient = ctx.createLinearGradient(0,0,0,400);
    gradient.addColorStop(0,'rgba(58,123,213,1)');
    gradient.addColorStop(1,'rgba(0,210,255,0.3)');
    const data = {
    labels: dates,
    datasets: [{
    label: 'My First dataset',
    backgroundColor: 'rgb(255, 99, 132)',
    borderColor: 'rgb(255, 99, 132)',
    data:price,
    fill : true,
    backgroundColor : gradient
    }]
    };
    const config = {
        type: 'line',
        data: data,
        options: {
        elements: {
        point:{
            radius : 0
        }
        },
    scales :{
        x:{
        ticks:{
            display : false
            }
        }

        } 
    }
};


var newmychart = new Chart(ctx,config);

    }}
    xhr.send();

    //nasdaq
let xhrnas = new XMLHttpRequest();
    xhrnas.open('GET','http://127.0.0.1:5000/search?time=3mo&stock=Dow',true);
    xhrnas.onload= function(){
    if(this.status == 200){
        let information = JSON.parse(this.responseText);
        let dates=JSON.parse(information[1]);
        let price =JSON.parse(information[0]);
        var ctx = document.getElementById("nasdaqChart").getContext("2d");
    // Gradient fill
    let gradient = ctx.createLinearGradient(0,0,0,400);
    gradient.addColorStop(0,'rgba(58,123,213,1)');
    gradient.addColorStop(1,'rgba(0,210,255,0.3)');
    const data = {
    labels: dates,
    datasets: [{
    label: 'My First dataset',
    backgroundColor: 'rgb(255, 99, 132)',
    borderColor: 'rgb(255, 99, 132)',
    data:price,
    fill : true,
    backgroundColor : gradient
    }]
    };
    const config = {
        type: 'line',
        data: data,
        options: {
        elements: {
        point:{
            radius : 0
        }
        },
    scales :{
        x:{
        ticks:{
            display : false
            }
        }

        } 
    }
};


var nasychart = new Chart(ctx,config);

    }}
    xhrnas.send();
    //sp500
let xhrsp = new XMLHttpRequest();
    xhrsp.open('GET','http://127.0.0.1:5000/search?time=3mo&stock=Dow',true);
    xhrsp.onload= function(){
    if(this.status == 200){
        let information = JSON.parse(this.responseText);
        let dates=JSON.parse(information[1]);
        let price =JSON.parse(information[0]);
        var ctx = document.getElementById("SP500Chart").getContext("2d");
    // Gradient fill
    let gradient = ctx.createLinearGradient(0,0,0,400);
    gradient.addColorStop(0,'rgba(58,123,213,1)');
    gradient.addColorStop(1,'rgba(0,210,255,0.3)');
    const data = {
    labels: dates,
    datasets: [{
    label: 'My First dataset',
    backgroundColor: 'rgb(255, 99, 132)',
    borderColor: 'rgb(255, 99, 132)',
    data:price,
    fill : true,
    backgroundColor : gradient
    }]
    };
    const config = {
        type: 'line',
        data: data,
        options: {
        elements: {
        point:{
            radius : 0
        }
        },
    scales :{
        x:{
        ticks:{
            display : false
            }
        }

        } 
    }
};


var spychart = new Chart(ctx,config);

    }}
    xhrsp.send();
</script>

{% endblock %}
